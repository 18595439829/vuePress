(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{399:function(n,t,e){"use strict";e.r(t);var a=e(44),r=Object(a.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"使用openlayer添加热力图-vue项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用openlayer添加热力图-vue项目"}},[n._v("#")]),n._v(" 使用openlayer添加热力图(vue项目)")]),n._v(" "),e("p",[n._v("项目地址"),e("a",{attrs:{href:"https://github.com/18595439829/vuecli3",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://github.com/18595439829/vuecli3"),e("OutboundLink")],1),n._v("dev分支")]),n._v(" "),e("h2",{attrs:{id:"效果示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#效果示例"}},[n._v("#")]),n._v(" 效果示例:")]),n._v(" "),e("p",[e("img",{attrs:{src:"/vuePress/img/%E7%83%AD%E5%8A%9B%E5%9B%BE.jpg",alt:"热力图.jpg"}})]),n._v(" "),e("h2",{attrs:{id:"_1-vue项目中下载ol包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-vue项目中下载ol包"}},[n._v("#")]),n._v(" 1.vue项目中下载ol包")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("npm install ol --save\n")])])]),e("h2",{attrs:{id:"_2-新建一个js文件-如-heatmap-js-引入ol必要的组件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-新建一个js文件-如-heatmap-js-引入ol必要的组件"}},[n._v("#")]),n._v(" 2.新建一个js文件,如:heatMap.js;引入ol必要的组件")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('// heatMap.js\nimport "ol/ol.css";\nimport Map from "ol/Map";\nimport View from "ol/View";\nimport OSM from "ol/source/OSM.js";\nimport Point from "ol/geom/Point.js";\nimport VectorSource from "ol/source/Vector.js";\nimport Feature from "ol/Feature.js";\nimport { fromLonLat } from "ol/proj.js";\nimport { Heatmap as HeatmapLayer, Tile as TileLayer } from "ol/layer";\n\nexport default class Heat {\n  constructor() {\n    // 地图底图源使用OSM,当然也可以用其他风格的源\n    const raster = new TileLayer({\n      source: new OSM(),\n    });\n    this.map = new Map({\n      layers: [raster], // 地图图层\n      target: "map", // 地图挂载的页面元素id,即下文HeatMap.vue中id="map"的div元素\n      view: new View({\n        center: fromLonLat([120.32714457090765, 30.30569628128095]), // 地图可视区域中心点,fromLonLat函数用于将经纬度转化为ol可正常识别的坐标\n        zoom: 11, // 地图缩放级别\n      }),\n    });\n  }\n  add(heatData) {\n    let source = new VectorSource(); // 新生成图层源,用于存放热力图图层\n    heatData.features.forEach((item) => { // 遍历热力图数据,生成热力图feature\n      const feature = new Feature({\n        geometry: new Point(fromLonLat(item.coordinates)),\n        weight: item.weight,\n      });\n      source.addFeature(feature);\n    });\n    this.heatLayer = new HeatmapLayer({ //新生成热力图图层,存放热力图feature\n      // 矢量数据源\n      source,\n      blur: 10, // 模糊尺寸\n      radius: 10, // 热点半径\n      weight(feature) {\n        const weight = feature.get("weight"); //获取feature的weight参数值,此处weight不可变更为其他参数,否则失效(暂时不明原因);\n        const magnitude = weight / 1;\n        return magnitude;\n      },\n    });\n    this.map.addLayer(this.heatLayer); // 将热力图添加在地图上\n  }\n  clear() {\n    this.map.removeLayer(this.heatLayer); // 将热力图从地图上移除\n  }\n}\n\n')])])]),e("h2",{attrs:{id:"_3-新建一个vue文件-如-heatmap-vue"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-新建一个vue文件-如-heatmap-vue"}},[n._v("#")]),n._v(" 3.新建一个vue文件,如: HeatMap.vue")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('// HeatMap.vue\n<template>\n  <div>\n    <div id="map" :class="$style[\'map\']"></div>\n    <Button @click="add">添加热力图</Button>\n    <Button @click="clear">清除热力图</Button>\n  </div>\n</template>\n<script>\nimport HeatMap from "@/views/ol/js/heatMap.js";\n\nexport default {\n  name: "HeatMap",\n  data() {\n    return {\n      heatMap: null,\n      // 热力图假数据\n      heatData: {\n        type: "FeatureCollection",\n        features: [\n          {\n            type: "Point",\n            coordinates: [120.10878812064284, 30.214101248758016],\n            weight: 100,\n          },\n          {\n            type: "Point",\n            coordinates: [120.06299060438137, 30.223642397979155],\n            weight: 19,\n          },\n          {\n            type: "Point",\n            coordinates: [120.01623897319779, 30.354356142308763],\n            weight: 419,\n          },\n          {\n            type: "Point",\n            coordinates: [20.32714457090765, 30.30569628128095],\n            weight: 319,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 719,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 519,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 319,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 139,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 129,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 190,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 189,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 1,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 119,\n          },\n          {\n            type: "Point",\n            coordinates: [120.32714457090765, 30.30569628128095],\n            weight: 200,\n          },\n          {\n            type: "Point",\n            coordinates: [120.11642104001974, 30.204560099536877],\n            weight: 300,\n          },\n        ],\n      },\n    };\n  },\n  mounted() {\n    this.initMap();\n  },\n  methods: {\n// 初始化地图,生成地图服务\n    initMap() {\n      this.heatMap = new HeatMap();\n    },\n// 添加热力图\n    add() {\n      this.heatMap.add(this.heatData);\n    },\n// 清除热力图\n    clear() {\n      this.heatMap.clear();\n    }\n  },\n};\n<\/script>\n\n<style lang="less" module>\n.map {\n  width: 100%;\n  height: 500px;\n}\n</style>\n\n')])])])])}),[],!1,null,null,null);t.default=r.exports}}]);