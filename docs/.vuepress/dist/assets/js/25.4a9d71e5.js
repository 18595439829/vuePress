(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{381:function(e,t,n){"use strict";n.r(t);var a=n(44),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"关于元素contenteditable时的dom操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于元素contenteditable时的dom操作"}},[e._v("#")]),e._v(" 关于元素contenteditable时的dom操作")]),e._v(" "),n("h2",{attrs:{id:"_1-光标的操作-document-execcommand"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-光标的操作-document-execcommand"}},[e._v("#")]),e._v(" 1.光标的操作: document.execCommand()")]),e._v(" "),n("blockquote",[n("p",[e._v("已废弃: This feature is obsolete. Although it may still work in some browsers, its use is discouraged since it could be removed at any time. Try to avoid using it.\n这个特性已经过时了。尽管它在一些浏览器中仍然可以工作，但不鼓励使用它，因为它可能随时被删除。尽量避免使用它")])]),e._v(" "),n("p",[e._v("https://developer.mozilla.org/zh-CN/docs/Web/API/Document/execCommand")]),e._v(" "),n("h3",{attrs:{id:"_1-1-在光标处插入元素"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-在光标处插入元素"}},[e._v("#")]),e._v(" 1.1 在光标处插入元素")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('document.execCommand(\'insertHTML\',\n   true,\n  \'<img id="cursor-position" src="" alt="" />\'\n)\n')])])]),n("h3",{attrs:{id:"_1-2-全选光标所在可编辑元素的内容"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-全选光标所在可编辑元素的内容"}},[e._v("#")]),e._v(" 1.2 全选光标所在可编辑元素的内容")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("this.$refs.text.focus()\ndocument.execCommand('selectAll', true)\n")])])]),n("h2",{attrs:{id:"_2-dom添加多个子节点使用createdocumentfragment-方法优化性能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-dom添加多个子节点使用createdocumentfragment-方法优化性能"}},[e._v("#")]),e._v(" 2.dom添加多个子节点使用createDocumentFragment()方法优化性能")]),e._v(" "),n("p",[e._v("https://developer.mozilla.org/zh-CN/docs/Web/API/Document/createDocumentFragment")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const fragment = document.createDocumentFragment()\nnodes.forEach(node => {\n     fragment.appendChild(node)\n})\ndom.appendChild(fragment)\n")])])]),n("h2",{attrs:{id:"_3-设置光标位置-光标移至元素末尾"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-设置光标位置-光标移至元素末尾"}},[e._v("#")]),e._v(" 3.设置光标位置(光标移至元素末尾)")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("//  光标移至dom元素末尾\nsetRange(){\n  const dom = document.getElementById('xxx')\n  const sel = window.getSelection()\n  const range = document.createRange()\n  range.selectNodeContents(dom)\n  range.collapse(false)\n  sel.removeAllRanges()\n  sel.addRange(range)\n}\n")])])]),n("h2",{attrs:{id:"_4-手动去除粘贴样式-只留下纯文本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-手动去除粘贴样式-只留下纯文本"}},[e._v("#")]),e._v(" 4.手动去除粘贴样式,只留下纯文本")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("// 使用\nwindow.addEventListener('paste', this.textInit)\n// 去除粘贴样式\ntextInit (e) {\n   e.preventDefault()\n   let text\n   const clp = (e.originalEvent || e).clipboardData\n   if (clp === undefined || clp === null) {\n     text = window.clipboardData.getData('text') || ''\n   } else {\n     text = clp.getData('text/plain') || ''\n   }\n   this.insertTextAtRange(text, e)\n},\n// 在光标处插入文本\ninsertTextAtRange (text, e) {\n   const clp = (e.originalEvent || e).clipboardData\n   if (clp === undefined || clp === null) {\n     if (text !== '') {\n       if (window.getSelection) {\n         const newNode = document.createElement('span')\n         newNode.innerHTML = text\n         window.getSelection().getRangeAt(0).insertNode(newNode)\n       } else {\n         document.selection.createRange().pasteHTML(text)\n       }\n     }\n   } else {\n     if (text !== '') {\n       document.execCommand('insertText', false, text)\n     }\n   }\n}\n")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);